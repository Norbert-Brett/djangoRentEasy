{% load static %} {% load django_browser_reload %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <!-- SEO and Accessibility -->
  <meta name="description" content="RentEasy - Find your perfect home away from home. Discover extraordinary accommodations around the world." />
  <meta name="theme-color" content="#2563eb" />
  
  <!-- Preload critical fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Custom Theme System -->
  <link rel="stylesheet" href="{% static 'css/style.css' %}" />
  <link rel="stylesheet" href="{% static 'css/lightbox.min.css' %}" />
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />

  <!-- Theme Configuration -->
  <script>
    // Theme system initialization
    (function() {
      const theme = localStorage.getItem('theme') || 
                   (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>

  <title>RentEasy {% block title %}{% endblock %}</title>
</head>

<body class="font-inter antialiased tracking-tight relative">
  <!-- Skip Link for Accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <!-- NavBar -->
  {% include 'partials/_navbar.html' %}
  
  <!-- Main Content -->
  <main id="main-content" class="min-h-screen flex flex-col">
    {% block content %} {% endblock %}
  </main>

  <!-- Footer -->
  {% include 'partials/_footer.html' %} 
  {% django_browser_reload_script %}

  <!-- Scripts -->
  <script src="{% static 'js/jquery-3.3.1.min.js' %} "></script>
  <script src="{% static 'js/main.js' %} "></script>
  <script src="{% static 'js/theme.js' %} "></script>
  <script src="//unpkg.com/alpinejs" defer></script>
  <script src="{% static 'js/lightbox.min.js' %}"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    // Initialize AOS
    AOS.init({
      once: true,
      disable: "phone",
      duration: 500,
      easing: "ease-out-cubic",
    });

    // Theme Toggle Functionality
    function initThemeToggle() {
      const themeToggleDesktop = document.getElementById('theme-toggle-desktop');
      const themeToggleMobile = document.getElementById('theme-toggle-mobile');
      const themeIconDesktop = document.getElementById('theme-icon-desktop');
      const themeIconMobile = document.getElementById('theme-icon-mobile');
      
      function updateThemeIcon(theme) {
        const iconClass = theme === 'dark' ? 'bi-moon-fill' : 'bi-sun-fill';
        if (themeIconDesktop) {
          themeIconDesktop.className = `bi ${iconClass}`;
        }
        if (themeIconMobile) {
          themeIconMobile.className = `bi ${iconClass}`;
        }
      }
      
      function toggleTheme() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        updateThemeIcon(newTheme);
        
        // Announce theme change for screen readers
        const announcement = `Theme changed to ${newTheme} mode`;
        const announcer = document.createElement('div');
        announcer.setAttribute('aria-live', 'polite');
        announcer.setAttribute('aria-atomic', 'true');
        announcer.className = 'sr-only';
        announcer.textContent = announcement;
        document.body.appendChild(announcer);
        setTimeout(() => document.body.removeChild(announcer), 1000);
      }
      
      // Initialize theme icon
      const currentTheme = document.documentElement.getAttribute('data-theme');
      updateThemeIcon(currentTheme);
      
      // Add event listeners
      if (themeToggleDesktop) {
        themeToggleDesktop.addEventListener('click', toggleTheme);
      }
      if (themeToggleMobile) {
        themeToggleMobile.addEventListener('click', toggleTheme);
      }
      
      // Listen for system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        if (!localStorage.getItem('theme')) {
          const newTheme = e.matches ? 'dark' : 'light';
          document.documentElement.setAttribute('data-theme', newTheme);
          updateThemeIcon(newTheme);
        }
      });
    }
    
    // Initialize theme toggle when DOM is loaded
    document.addEventListener('DOMContentLoaded', initThemeToggle);
  </script>
</body>

</html>